https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=190810


2006-09-26  Jan Kratochvil  <jan.kratochvil@redhat.com>

	* remote.c (remote_wait): Suggestion on crash due to nonmatching target.
	(remote_async_wait): Likewise.


Index: gdb-6.6/gdb/remote.c
===================================================================
--- gdb-6.6.orig/gdb/remote.c	2007-01-20 06:43:04.000000000 +0100
+++ gdb-6.6/gdb/remote.c	2007-01-20 06:55:50.000000000 +0100
@@ -3111,8 +3111,13 @@ Packet: '%s'\n"),
 					 reg->regnum, regs);
 		  }
 
+		/* It may also occur on amd64 which defaults to 32-bit i386
+		   target.  gdbserver(1) is not aware of the `set architecture'
+		   name itself as it is not using libbfd.  */
 		if (*p++ != ';')
-		  error (_("Remote register badly formatted: %s\nhere: %s"),
+		  error (_("Remote register badly formatted: %s\nhere: %s"
+			   "\nTry to load the executable by `file' first,"
+			   "\nyou may also check `set/show architecture'."),
 			 buf, p);
 	      }
 	  }
@@ -3307,8 +3312,13 @@ Packet: '%s'\n"),
 		    regcache_raw_supply (current_regcache, reg->regnum, regs);
 		  }
 
+		/* It may also occur on amd64 which defaults to 32-bit i386
+		   target.  gdbserver(1) is not aware of the `set architecture'
+		   name itself as it is not using libbfd.  */
 		if (*p++ != ';')
-		  error (_("Remote register badly formatted: %s\nhere: %s"),
+		  error (_("Remote register badly formatted: %s\nhere: %s"
+			   "\nTry to load the executable by `file' first,"
+			   "\nyou may also check `set/show architecture'."),
 			 buf, p);
 	      }
 	  }
